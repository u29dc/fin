@import "tailwindcss";
@custom-variant dark (&:where(.dark, .dark *));

/* Gate hover styles to devices that support hover (prevents flash on touch) */
@custom-variant can-hover (@media (hover: hover));

/* Screen reader only utility */
.sr-only {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border-width: 0;
}

@theme {
	--breakpoint-3xl: 1700px;
	--color-bg: var(--bg);
	--color-panel: var(--panel);
	--color-border: var(--border);
	--color-border-subtle: var(--border-subtle);
	--color-text: var(--text);
	--color-muted: var(--muted);
	--color-error: var(--error);
	--color-success: var(--success);
	--color-pending: var(--pending);
	--color-active-bg: rgba(255, 255, 255, 0.06);
	--font-mono: 'Fira Code', 'JetBrains Mono', 'SFMono-Regular', Menlo, Monaco, Consolas, monospace;
	--text-2xs: 10px;
	--text-xs: 11px;
	--text-sm: 12px;
	--text-base: 13px;
	--text-lg: 14px;
}

/* Chart component shared styles */
.chart-wrap {
	@apply relative w-full;
}

.chart-inner {
	@apply w-full;
}

.hover-label {
	@apply absolute top-2 left-2 z-[2] pointer-events-none opacity-0;
	@apply transition-opacity duration-[80ms];
	@apply text-xs tracking-wider uppercase leading-none;
	@apply py-[3px] px-1.5;
	color: var(--text);
	background: var(--panel);
	border: 1px solid var(--border);
}

.hover-label.visible {
	@apply opacity-100;
}

/* iOS Safari viewport height fix - fallback chain */
html {
	height: 100%;
	overscroll-behavior: none;
}

/* Light theme (default) */
:root {
	color-scheme: light;
	--bg: #f8f9fa;
	--panel: #ffffff;
	--border: #e1e4e8;
	--border-subtle: rgba(0, 0, 0, 0.06);
	--text: #1a1a1a;
	--muted: #6b7280;
	--text-secondary: var(--muted);
	/* Color-blind safe palette: teal for income, orange for expense */
	--error: #ea580c;
	--success: #0d9488;
	--pending: #ca8a04;

	/* Custom easing curves - Rauno Freiberg's recommendations */
	--ease-out: cubic-bezier(0.16, 1, 0.3, 1);
	--ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
	--ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);

	/* Viewport height - modern browsers use svh, legacy uses --vh from JS */
	--app-height: 100svh;
}

/* JS fallback for browsers without svh support */
@supports not (height: 100svh) {
	:root {
		--app-height: calc(var(--vh, 1vh) * 100);
	}
}

/* Dark theme */
.dark {
	color-scheme: dark;
	--bg: #0d0f10;
	--panel: #111315;
	--border: #24272c;
	--border-subtle: rgba(255, 255, 255, 0.06);
	--text: #e6e6e8;
	--muted: #9aa0a6;
	/* Color-blind safe palette: teal for income, orange for expense */
	--error: #fb923c;
	--success: #2dd4bf;
	--pending: #f0b429;
}

body {
	/* Viewport height fallback chain - last supported value wins */
	min-height: 100vh;
	min-height: -webkit-fill-available;
	min-height: 100svh;
	overscroll-behavior: none;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
	-webkit-text-size-adjust: 100%;
	-webkit-tap-highlight-color: transparent;
	text-rendering: optimizeLegibility;
}

/* Text selection styling */
::selection {
	background: var(--text);
	color: var(--bg);
}

/* Prevent iOS zoom on input focus */
input,
textarea,
select {
	font-size: 16px;
}


button {
	font-family: inherit;
	user-select: none;
}

/* Prevent double-tap zoom on touch devices */
button,
a {
	touch-action: manipulation;
}

/* Global interactive element transitions */
button,
a {
	transition:
		background 150ms var(--ease-out),
		color 150ms var(--ease-out),
		border-color 150ms var(--ease-out),
		transform 150ms var(--ease-out),
		box-shadow 150ms var(--ease-out),
		opacity 150ms var(--ease-out);
}

/* Button press feedback - subtle scale down */
button:active:not(:disabled),
a:active {
	transform: scale(0.97);
}

/* Focus-visible styling with box-shadow (respects border-radius) */
button:focus-visible,
a:focus-visible {
	outline: none;
	box-shadow:
		0 0 0 2px var(--bg),
		0 0 0 4px var(--text);
}

/* Disabled button styling */
button:disabled {
	cursor: not-allowed;
	opacity: 0.5;
}

/* Fade-in animation - subtle translateY for staggered elements */
@keyframes fade-in {
	from {
		opacity: 0;
		transform: translateY(6px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

.fade-in {
	animation: fade-in 200ms var(--ease-out) both;
}

.fade-in-delay-1 {
	animation-delay: 50ms;
}

.fade-in-delay-2 {
	animation-delay: 100ms;
}

/* Respect reduced motion preference - disable all animations and transitions */
@media (prefers-reduced-motion: reduce) {
	.fade-in,
	.fade-in-delay-1,
	.fade-in-delay-2 {
		animation: none;
		opacity: 1;
	}

	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		transition-duration: 0.01ms !important;
	}
}
